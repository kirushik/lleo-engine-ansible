---
- name: Install ufw firewall
  apt: name=ufw state=present

- name: Open desired ports
  ufw: rule=allow port={{ item }} proto=tcp
  with_items:
    - 22
    - 80

- name: Turn ufw on
  ufw: state=enabled

- name: Restrict ssh access to current user only
  user: name={{ansible_env.SUDO_USER}} groups=ssh append=yes

- name: Overwrite sshd config
  copy: src=sshd_config dest=/etc/ssh/sshd_config
  notify:
    - restart ssh daemon

- name: Create user for lleo engine
  user: name=dnevnik shell=/dev/null system=yes

- name: Add current sudoer to all those user's groups
  user: name={{ansible_env.SUDO_USER}} groups=dnevnik append=yes

- name: User setgid on engine folder
  file: name=~dnevnik mode=2770